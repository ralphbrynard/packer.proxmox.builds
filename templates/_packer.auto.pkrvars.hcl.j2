/*
   DESCRIPTION:
   Generated auto.pkrvars file for GitHub Actions builds.
*/

// Build metadata
build_version = "{{ build_version }}"

// Proxmox Variables
proxmox_api_endpoint = {{ proxmox_api_endpoint }}
proxmox_node = {{ proxmox_node }}
proxmox_username = {{ proxmox_username }}
proxmox_api_token = {{ proxmox_api_token }}
proxmox_insecure_connection = {{ proxmox_insecure_connection | default(true) }}
proxmox_bridge_interface = {{ proxmox_bridge_interface | default("vmbr0") }}

// Virtual Machine Settings
vm_firmware                    = {{ vm_firmware }}
enable_qemu_agent              = {{ enable_qemu_agent | default(true) }}
vm_scsi_controller             = {{ vm_scsi_controller | default("virtio-scsi-single") }}
enable_start_on_boot           = {{ enable_start_on_boot | default(true) }}
vm_disk_storage_pool           = {{ vm_disk_storage_pool }}
vm_nic_model                   = {{ vm_nic_model | default("e1000") }}
vm_nic_vlan_tag                = {{ vm_nic_vlan_tag | default("13") }}
{%- if build_type == "win11" -%}
vm_name                        = {{ vm_name | default("w11") }}
vm_mem_size                    = 4096
enable_dynamic_mem             = false
vm_cpu_core_count              = 2
vm_cpu_count                   = 2
vm_inst_os_kms_key_ent         = {{ vm_inst_os_kms_key_ent }}
vm_inst_os_kms_key_pro         = {{ vm_inst_os_kms_key_pro }}
vm_os                          = "win11"
vm_guest_os                    = "windows"


// Provisioner Settings
scripts = ["scripts/windows/windows-prepare.ps1"]
inline                         = ["Get-EventLog -LogName * | ForEach { Clear-EventLog -LogName $_.Log }"]

// Removeable Media Settings
additional_iso_storage_pool     = "packer_iso"
iso_file                        = "local:iso/en-us_windows_11_business_editions_version_22h2_updated_oct_2023_x64_dvd_e6b6f11c.iso"

// Cloud Init
enable_cloud_init       = true
cloud_init_storage_pool = "cidata"

// Boot Settings
vm_boot_wait = "3s"

// Communicator Settings
communicator_winrm_port     = 5985
communicator_use_proxy      = false
communicator_host           = null
communicator_timeout        = "12h"
communicator_winrm_use_ssl  = false
communicator_winrm_insecure = true
communicator_winrm_use_ntlm = false
{%- endif -%}
